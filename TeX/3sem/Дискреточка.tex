\documentclass{book}
%nerd stuff here
\pdfminorversion=7
\pdfsuppresswarningpagegroup=1
% Languages support
\usepackage[utf8]{inputenc}
\usepackage[T2A]{fontenc}
\usepackage[english,russian]{babel}
% Some fancy symbols
\usepackage{textcomp}
\usepackage{stmaryrd}
% Math packages
\usepackage{amsmath, amssymb, amsthm, amsfonts, mathrsfs, dsfont, mathtools}
\usepackage{cancel}
% Bold math
\usepackage{bm}
% Resizing
%\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}
% Optional font for not math-based subjects
%\usepackage{cmbright}

\author{Коченюк Анатолий}
\title{Дискретная математика, 3 семестр}

\usepackage{url}
% Fancier tables and lists
\usepackage{booktabs}
\usepackage{enumitem}
% Don't indent paragraphs, leave some space between them
\usepackage{parskip}
% Hide page number when page is empty
\usepackage{emptypage}
\usepackage{subcaption}
\usepackage{multicol}
\usepackage{xcolor}
% Some shortcuts
\newcommand\N{\ensuremath{\mathbb{N}}}
\newcommand\R{\ensuremath{\mathbb{R}}}
\newcommand\Z{\ensuremath{\mathbb{Z}}}
\renewcommand\O{\ensuremath{\emptyset}}
\newcommand\Q{\ensuremath{\mathbb{Q}}}
\renewcommand\C{\ensuremath{\mathbb{C}}}
\newcommand{\p}[1]{#1^{\prime}}
\newcommand{\pp}[1]{#1^{\prime\prime}}
% Easily typeset systems of equations (French package) [like cases, but it aligns everything]
\usepackage{systeme}
\usepackage{lipsum}
% limits are put below (optional for int)
\let\svlim\lim\def\lim{\svlim\limits}
\let\svsum\sum\def\sum{\svsum\limits}
%\let\svlim\int\def\int{\svlim\limits}
% Command for short corrections
% Usage: 1+1=\correct{3}{2}
\definecolor{correct}{HTML}{009900}
\newcommand\correct[2]{\ensuremath{\:}{\color{red}{#1}}\ensuremath{\to }{\color{correct}{#2}}\ensuremath{\:}}
\newcommand\green[1]{{\color{correct}{#1}}}
% Hide parts
\newcommand\hide[1]{}
% si unitx
\usepackage{siunitx}
\sisetup{locale = FR}
% Environments
% For box around Definition, Theorem, \ldots
\usepackage{mdframed}
\mdfsetup{skipabove=1em,skipbelow=0em}
\theoremstyle{definition}
\newmdtheoremenv[nobreak=true]{definition}{Определение}
\newmdtheoremenv[nobreak=true]{theorem}{Теорема}
\newmdtheoremenv[nobreak=true]{lemma}{Лемма}
\newmdtheoremenv[nobreak=true]{problem}{Задача}
\newmdtheoremenv[nobreak=true]{property}{Свойство}
\newmdtheoremenv[nobreak=true]{statement}{Утверждение}
\newmdtheoremenv[nobreak=true]{corollary}{Следствие}
\newtheorem*{note}{Замечание}
\newtheorem*{example}{Пример}
\renewcommand\qedsymbol{$\blacksquare$}
% Fix some spacing
% http://tex.stackexchange.com/questions/22119/how-can-i-change-the-spacing-before-theorems-with-amsthm
\makeatletter
\def\thm@space@setup{%
  \thm@preskip=\parskip \thm@postskip=0pt
}
\usepackage{xifthen}
\def\testdateparts#1{\dateparts#1\relax}
\def\dateparts#1 #2 #3 #4 #5\relax{
    \marginpar{\small\textsf{\mbox{#1 #2 #3 #5}}}
}

\def\@lecture{}%
\newcommand{\lecture}[3]{
    \ifthenelse{\isempty{#3}}{%
        \def\@lecture{Lecture #1}%
    }{%
        \def\@lecture{Lecture #1: #3}%
    }%
    \subsection*{\@lecture}
    \marginpar{\small\textsf{\mbox{#2}}}
}
% Todonotes and inline notes in fancy boxes
\usepackage{todonotes}
\usepackage{tcolorbox}

% Make boxes breakable
\tcbuselibrary{breakable}
\newenvironment{correction}{\begin{tcolorbox}[
    arc=0mm,
    colback=white,
    colframe=green!60!black,
    title=Correction,
    fonttitle=\sffamily,
    breakable
]}{\end{tcolorbox}}
% These are the fancy headers
\usepackage{fancyhdr}
\pagestyle{fancy}

% LE: left even
% RO: right odd
% CE, CO: center even, center odd
% My name for when I print my lecture notes to use for an open book exam.
% \fancyhead[LE,RO]{Gilles Castel}

\fancyhead[RO,LE]{\@lecture} % Right odd,  Left even
\fancyhead[RE,LO]{}          % Right even, Left odd

\fancyfoot[RO,LE]{\thepage}  % Right odd,something additional 1  Left even
\fancyfoot[RE,LO]{}          % Right even, Left odd
\fancyfoot[C]{\leftmark}     % Center

\usepackage{import}
\usepackage{xifthen}
\usepackage{pdfpages}
\usepackage{transparent}
\newcommand{\incfig}[1]{%
    \def\svgwidth{\columnwidth}
    \import{./figures/}{#1.pdf_tex}
}
\usepackage{tikz}
\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\Beg}{Beg}
\DeclareMathOperator{\len}{len}
\DeclareMathOperator{\Ker}{Ker}
\DeclareMathOperator{\Chi}{Chi}
\DeclareMathOperator{\Def}{Def}
\begin{document}
    \maketitle
    \chapter{Графы, неалгоритмические свойства}
    \section{Что такое граф}

    $V, E\subseteq V\times V$ -- конечные множества

    Такая конструкция называется (обыкновенным) ориентированным графом

    \begin{note}
        В таком графе нет параллельных рёбер. 

    Ориентированный, потому что у ребра есть начало и конец.    \end{note}

    \begin{definition}
        $V, E, beg:E\to V, end:E\to V$

        Граф с кратными рёбрами (ориентированный мультиграф)
    \end{definition}

    \begin{note}
        Если дополнительно затребовать, что для любых \[uv, ab\quad u\neq a \vee v\neq b\]
    \end{note}

    \begin{note}
        $uv\sim vu\quad V, E\subseteq \left( V\times V \right) /_{\sim}$

        неориентированный граф с петлями

        $uv\sim vu\quad V, E\subseteq \left( V\times V \right) /_{\sim} \setminus \left\{ (u,u)|u\in V \right\} $

        неориентированный граф без петель (обыкновенный)
    \end{note}

    \begin{note}
        Альтернативно $V, E, ends:E \to \left( V\times V \right) /_{\sim} \left[ \setminus \left\{ (u,u)|u\in     V \right\}\right]$

        Граф с кратными рёбрами [без петель] (мультиграф)
    \end{note}

    \begin{note}
        Неориетированный граф -- ориаентированный, где есть рёбра (дуги) в обе стороны
    \end{note}

    \section{Ориентированный граф}
    У ребра есть начло и конец. Говорят, что ребро выходит из вершины и входит в вершины.

    Когда из вершины выходит $n$ рёбер, это число обозначается  $d^-u$ и называется исходящей степенью вершины

    Когда в вершину выходит $n$ рёбер, это число обозначается  $d^+u$ и называется входящей степенью вершины

    \begin{lemma}
        $\sum_u deg^+u = \sum_u deg^-u = |E|$
    \end{lemma}
    \begin{definition}
    Пусть $P = u_0 e_1 u_1 e_1 u_2 \ldots e_k u_k$
     
    $e_i = u_{i-1}u_i$

     $u_0 = \Beg P\quad u_k = \End P$

     $k = \len P = |P|$

      $a\leadsto b\quad \exists $ путь $P: \Beg P = a, \End P = b$
    \end{definition}

    \begin{lemma}
        $\leadsto = \to^*$
    \end{lemma}

    \begin{corollary}
        $\leadsto$ -- транзитивно, рефлексивно
    \end{corollary}

    \begin{definition}
        $a\leftrightsquigarrow b \iff a\leadsto b ,  b \leadsto a$

        Тогда это отношение эквивалентности, а граф, где вершины могут быть связаны только так, называется сильно связанным.
    \end{definition}

    \begin{definition}
        Если выполняется $a\leadsto b \implies \text{ не }b\leadsto a$

        такой граф называется ациклическим
    \end{definition}

    \begin{definition}
        Циклическим путём называется путь, у которого начало и конец совпадают и длина больше нуля.

        Циклом (в ориентированным графе) называется класс эквивалентности циклическим путей, в котором пути равны с точностью до циклического сдвига.

        Путь (цикл) называется простым, если все вершины на нём различны

        путь (цикл) называется рёберно-простым, если в нём все рёбра различны.
    \end{definition}

    \begin{statement}
        $a\leadsto b$ антисимметричный  $\iff $ в $G$ нет циклов длины 2 и более.
    \end{statement}

    \begin{lemma}
        $G$ -- ациклический граф  $\implies \exists $ вершина исходящей степени ноль.
    \end{lemma}
    \begin{corollary}
        В ациклическом графе можно построить topsort

        $n:V\to \N \quad uv\in E \implies  n(u) < u(v)$
    \end{corollary}
    \begin{proof}
        Одна вершина очень хорошо сортируется

        По лемме есть вершина исходящей степени ноль. Удалим её временно из графа. Меньший граф сортируется по индукционном предположению. Добавляем первую вершину, она ничего не ломает, так как в неё не входят рёбра.
    \end{proof}

    \section{Неориентированный граф}
    \begin{definition}
        Путём называется последовательность $u_0e_1u_1\ldots e_ku_k$

        $e_i = u_{i-1}u_i$
    \end{definition}

    \begin{definition}
        Циклический путь -- путь, где начало = концу и длина ненулевая.. Тогда путь $aebea$ по одному ребру в две стороны был бы циклическим путём.. а мы не хотим называть такое циклом.

        Назовём циклическим путём корректным, если  $\forall i\quad e_i = e_{i+1} \implies  e_i$ петля. $e_k = e_1 \implies  e_k$ петля

        Назовём циклом класс эквивалентности корректных циклических путей относительно равенства с точностью до циклического сдвига отражения.
    \end{definition}

    \begin{note}
        $\leadsto$ -- отношение эквивалентности, потому что есть симметричности в силу неориентированности.

        Классы эквивалентности -- компоненты связности.

        Если граф состоит из одной компоненты связности, то он называется связным
    \end{note}

    \begin{note}
        Ориентированному графу $G$ можно сделать симметризацию  $\overset{\leftrightarrow} G$

        Обратно можно сделать ориентацию неориентированному графу, заменив каждое ребро на стрелку в одну стороны (соответственно  $2^{|E|}$ ориентаций)
    \end{note}

    \begin{definition}
        Отношение ``связаны ребром'' называется отношением смежности

        Если из вершины исходит ребро, то отношение между ребром и вершиной называется отношением инцидентности.

        $\deg u$ -- количество рёбер, инцидентных данной вершине
    \end{definition}

    \begin{lemma}
        [о рукопожатиях] $\sum \deg u = 2|E|$
    \end{lemma}

    \begin{definition}
        Лес -- ациклические неориентированный граф

        Дерево -- лес, связный 
    \end{definition}

    \begin{definition}
        $u, v$ рёберно-двусвязны, если  $\exists $ два рёберно-непересекающихся пути $u\leadsto v$

        Классы эквивалентности -- листы

        Если удалить вершину, связывающую разные листы, то эти листы перестанут быть связанными. Такие вершины называются хвостами 
    \end{definition}

    \begin{theorem}
        Рёберно-двусвязность -- отношение эувивалентности
    \end{theorem}
    \begin{proof}
        Транзитивность: 

\begin{figure}[!ht]
    \centering
    \incfig{trans}
    \caption{trans}
    \label{fig:trans}
\end{figure}
    \end{proof}

    \begin{note}
        Если вводить аналогичную вершинную двусвязность с патчем, что концы могут совпадать, то облом:

\begin{figure}[!ht]
    \centering
    \incfig{oblom}
    \caption{oblom}
    \label{fig:oblom}
\end{figure}

$a, b\quad b, c$ вершинно двусвязны, но  $a, c$ явно нет
    \end{note}

    \begin{definition}
        Ребра вершинно двусвязны, если междц ними есть два пути, которые вершинно непересекаются (концы тоже должны не совпадать)

        Классы эквивалентности -- блоки

        Если удалить ребро, связывающее два разных блока, то его концы перестанут быть связанными. Такие рёбра называется мостами.
    \end{definition}

    \section{Деревья}

    \begin{definition}
        Неориентированный граф называется лесом, если в нём нет циклов.

        Неориентированный граф называется деревом, если он является лесом и связным.
    \end{definition}
    \begin{theorem}
        \begin{enumerate}
            \item граф связен
            \item граф ацикличен
            \item количество рёбер на 1 меньше количества вершин $|E| = |V|-1$.
        \end{enumerate}

        Из любых двух из этих свойств следует третье.
    \end{theorem}
    \begin{lemma}
        Пусть есть дерево (связный граф без циклов), содержащее хотя бы $2$ вершины. Тогда существует вершина степени 1.
    \end{lemma}
    \begin{proof}
        Рассмотрим самый длинный простой путь. Его концы имеют степень 1. Пусть нет, пусть есть вершина, которая не лежит на диаметре и является соседом конца, но тогда диаметр не самый длинный путь. Иначе сосед конца лежит внутри диаметра, что значит появление цикла, а у нас дерево.
    \end{proof}
    \begin{proof}
        [Доказательство теоремы]

       \begin{itemize}
           \item [$1, 2\implies 3$] $|V| = 1 \implies |E| = 0$. Петлей нет. Даже если разрешить, петля это цикл, что запрещено по ацикличности

               Если есть хотя бы две вершины, то есть вершина степени 1. Возьмём её, удалим из графа и получим дерево из индукционного предполоожения. Получаем $n$ вершин и $n-1$ ребро
           \item[$1,3\implies 2$] Предположим, что цикл есть. Удалим любое ребро этого цикла. Получим граф, в котором $n$ вершин и $n-2$ ребра. Граф всё ещё связен (можно пройти по циклу вместо удалённого ребра). Рассмотрим все связные подграфы (есть как миниму он сам) и выберем минимальный по числу рёбер.  $n$ вершин и  $n-k$  рёбер. Он ациклический (потому что иначе можно удалить ребро без потери связности), тогда по первому пункту  $n-k = n-1$??

               Можно прямее: возьмём минимальный по числу рёбер связный подграф, он ациклический, значит $n-k = n-1$, значит он совпадает с нашим.
           \item [$2, 3\implies 1$] Каждая компонента связна и ациклична, значит в каждой из них $n_i$ вершин и  $n_i-1$ рёбер. Просуммируем и получим  $n$ вершин и  $n-k$ рёбер. Но по 3 рёбер у нас  $n-1\implies n-k = n-1 \implies k=1$ -- есть ровно одна компонента связности
       \end{itemize}
    \end{proof}

    \begin{theorem}
        В дереве между любыми двумя вершинами существует один простой путь
    \end{theorem}
    \begin{proof}
        Допустим есть два простых путя между двумя вершинами. Найдём общий префикс и место, где пути ветвятся. Найдём общий суффикс и место, где пути ветвятся. Между этими двумя путями согласно нашему определению есть корректный цикл. В дереве нашли цикл?!
    \end{proof}

    \begin{statement}
        Все рёбра дерева являются мостами.

        Верно также и обратное.
    \end{statement}

    \begin{definition}
        $T$ -- подграф  $G$ -- называется остовным дерево, если  $T$ остовный граф
    \end{definition}

    \begin{definition}
        Подграф:
        \begin{itemize}
            \item Откидываем любое количество вершин и рёбер
            \item Остовный подграф, не удаляем вершины, они сохраняют отношение связности
        \end{itemize}
    \end{definition}

    \begin{statement}
        Любой связный граф содержит остовное дерево.
    \end{statement}
    \begin{proof}
        минимальный по количеству рёбер связный подграф.
    \end{proof}

    \begin{definition}
        Матрица смежности. $A[i][j] = \begin{cases}
            1, \text{есть ребро из} i \text{ в } j\\
            0, \text{иначе}
        \end{cases}$
    \end{definition}

    \begin{theorem}
        $A^k[i][j]$ -- число путей из  $i$ в  $j$ длины  $k$
    \end{theorem}
    \begin{proof}
        $A^0 = I\quad A^1 = A$

        $A^k = A^{k-1}A \quad A^K[i][j] = \sum_t A^{k-1}[i][t] \cdot  A[t][j]$

        Рассмотрим путь из $i$ в  $j$ длины  $k$, разобьём его на две части длины  $k-1$ и  $1$. Тогда количество путей считается именно так, как произведение количества первых на количество вторых.
    \end{proof}

    Возьмём матрицу смежности и на диагонали напишем минус степени вершин

    $\begin{pmatrix} 3&-1&-1&-1\\-1&2&-1&-0\\-1&-1&3&-1\\-1&-0&-1&2 \end{pmatrix} $ -- матрица Кирхгофа.

    Вычеркнем одну строку и одну столбец. Посчитаем определитель и получим количество остовных деревьев.

    \begin{theorem}
        Количество остовных деревьев неориентированного графа равно алгебраическому дополнению любого элемента матрицы Кирхгофа
    \end{theorem}
    \begin{proof}
        Рассмотрим любую ориентацию нашего графа $G$. Рассмотрим матрицу инцидентности $\vec G$ --  $I_{\vec G}$ -- в каждом столбце есть -1, 1 и остальные все нули.

         \begin{lemma}
             $K_G = I_{\vec G}I^T_{\vec G}$
        \end{lemma}
        \begin{proof}
            на диагоналях скалярное произведение равных строк, где стоят 1 или -1 на местах рёбер. В сумме это степень вершины.

            Если не диагональный: будет 0, если не соединены ребром и -1, если соиденены ($1 \cdot  -1$) (здесь пригождается ориентация)
        \end{proof}
        \begin{lemma}
            $\sphericalangle $ минор $(n-1)\times (n-1)$ матрицы $I_{\vec G}$. Задаётся множеством рёбер и вершиной, которую выкидыванием. Утверждается, что этот минор равен нулю, если множество рёбер содержит цикл и $\pm 1$ иначе.
        \end{lemma}
        \begin{proof}
            рассмотрим цикл  -- какие-то рёбра. Просуммируем соответствующие столбцы и получим нулевой столбец (если цикл ориентированный. В противном случае, просуммируем с нужными коэффициентами). А тогда мы получим линейно-зависимые столбцы в миноре, следовательно он будет равен нулю.

            Иначе, пусть $v_1$ -- висячая вершина (лист)  $A, v_1\neq u$. Поставим в миноре строку $v_1$ в начало, как и столбец с её единственным ребром $[0][0] = \pm 1$, всё остальное в строке 0. Удалим её из дерева., по усиленной лемме о висячих вершинах, есть два листа, хотя бы один из которых не  $u$. Проделаем с ней --  $v_2$ -- те же действия. Так сделам со всеми и получим треугольную матрицу, у которой на диагонали стоят $\pm 1$, значит сам минор равен  $\pm 1$
        \end{proof}
        \begin{lemma}
            $\widehat{K_{G_{ii}}} = (I_{\vec G} \setminus  \left\{ i\text{ стр.} \right\})\cdot \left( I^T_{\vec G}\setminus \left\{ i \text{ столбца} \right\}  \right)  $
        \end{lemma}
        \begin{lemma}
            [Формула  Коши-Бине]

        \[A_{r\times r}\quad A = B\cdot C\quad B_{r\times s}\quad C_{s\times r}\quad s \geqslant r\]

        \[\det A = \sum_{1\leqslant i_1<\ldots< i_r\leqslant s}\det B^{i_1i_2\ldots i_r}\det C_{i_1i_2\ldots i_r}\]
        \end{lemma}
        \begin{theorem}
            [lite]

            Число основных деревьев $G = $ алгебраическому дополнению матрицы Кирхгофа.
        \end{theorem}
    \end{proof}

    \section{Циклическое пространство}

    Рассмотрим матрицу инцидентности $A:\mathbb B^m \to \mathbb B^n$

    $\Ker A = \left\{ C|C\subset E, C \text{ -- дизъюнктное объединение циклов} \right\} $


    \section{Эйлеровы и Гамильтоновы графы}

    \begin{definition}
        Цикл (путь) называется эйлеровым, если он проходит по каждому ребру в графе ровно один раз

    \end{definition}

    \begin{theorem}
        Неориентированный граф содержит Эйлеров цикл тогда и только тогда, когда все вершины имеют чётную степень, граф связен (кроме конпонент связности из одной вершины -- пней) и есть хотя бы одно ребро.
    \end{theorem}
    \begin{proof}
       \begin{statement}
           $G$ -- граф, что все степени вершин чётные и любая компонента связности содержит больше одно ребра, тогда любая компонента содержит эйлеров цикл
       \end{statement} 
       \begin{proof}
           Если рёбер 0, то все компоненты связности содержат эйлеров цикл (все ноль компонент связности)

           Пусть рёбра есть. Возьмём одно ребро. т.к. степень чётная, то мы можем идти в одну из сторон. В какой-то момент из-за чётности мы успрёмся в вершину, в которй уже были, так мы найдём цикл, удалим его из графа и рассмотрим компоненты связности. По нидукционному предположению во всех них есть эйлеров цикл. Дальше обойдём цикл и когда попадаем в новую компоненту, выписываем подряд его цикл и идём дальше.
       \end{proof}
    \end{proof}
       \begin{note}
           Разрешим кратные рёбра и петли. Утверждение всё ещё верно. Если есть вершина степени хотя бы 2, возьмём два соседних с ней ребра, удалим их и совместим (если есть, то добавим ещё одно ребро) соответствующие вершины. Тогда по индукции в образовавшихся компонентах есть эйлеровы циклы и дальше мы заменяем ребро обратно на 2 ребра. Возможно при этом нужно будет включить эйлоров цикл компоненты связности, в которой находилась выбранная вершина
       \end{note}

       \begin{corollary}
           Неориентированный граф содержит Эйлеров путь тогда и только тогда, когда все уго компоненты связности, кроме $\leqslant 1$ содержат хотя бы одну вершину и степени всех вершин чётны, кроме $\leqslant 2$
       \end{corollary}

       \begin{theorem}
           В ориентированном графе существует Эйлеров цикл тогда и только тогда, когда $\forall u:\quad \deg^+ u = \deg^-u$
       \end{theorem}

       \begin{definition}
           Гамильтонов цикл (путь) -- проходит по любой вершине ровно один раз
       \end{definition}
       
       Поиск и проверка существования -- NP-полные задачи.

       Критерии: связность, нет висячих рёбер, нет точек сочленения

\begin{figure}[!ht]
    \centering
    \incfig{gamil}
    \caption{gamil}
    \label{fig:gamil}
\end{figure}

\begin{statement}
    В полном графе $(K_n, n\geqslant 3)$ есть гамильтонов цикл

    Если степень любой вершины $\geqslant \frac{n}{2}$, то тоже (теорема Дирака)
\end{statement}

\begin{theorem}
    [Критерий Хватала]

    $[d](*) \implies \forall G[d]\quad\exists $ гамильтонов цикл

    $\neg [d](*) \implies \exists G[d]: \nexists$ гамильтонова цикла

    \hrule

    Пусть $G$ содержит  $\geqslant 3$ вершин, степени вершин $d_1 \leqslant  d_2 \leqslant  \ldots \leqslant  d_n$.

    И выполнено *: $d_k \leqslant k<\frac{n}{2} \implies d_{n-k}\geqslant n-k$ 

    Тогда $G$ гамильтонов 

    (Хватал $\implies $ Дирак)
\end{theorem} 
\begin{proof}
    Пусть $G$ -- контпример к теореме Хватова. Среди всех контрпримеров возьмём минимальный по количеству вершин, в среди них возьмём тот, у которого максимальное число рёбер.

     $G \neq  K_n$

     \begin{lemma}
         Если граф удовлетворяет * и $uv \not\in EG \implies G\cup uv$ удовлетворяет *
         
        Импликации могут только стать ``лучше'', истинность не поменяется
     \end{lemma}
     \begin{figure}[!ht]
        \centering
        \incfig{lem1}
        \caption{lem1}
        \label{fig:lem1}
    \end{figure}
     \begin{lemma}
         $\sphericalangle uv\not\in EG]quad G\cup uv$ содержит гамильтонов цикл

         (т.к. $G$ контрпример с максимальным числом рёбер,  $G\cup uv$ удовлетворяет * по предыдущей емме)
     \end{lemma}
     $\sphericalangle uv\not\in EG: \deg u + \deg v \to \max$. НУО $\deg u \leqslant \deg v$

\begin{figure}[!ht]
    \centering
    \incfig{numer}
    \caption{numer}
    \label{fig:numer}
\end{figure}

$S = \left\{ i| uu_{i+1}\in G  \right\} \subset \left\{ 1, 2, \ldots, n-1 \right\} $

$T= {i| u_jv\in G} \subseteq \left\{ 1, 2, \ldots, n-1 \right\} $

\begin{lemma}
    $S \cap T = \O $ 

\end{lemma}
\begin{figure}[!ht]
    \centering
    \incfig{st}
    \caption{st}
    \label{fig:st}
\end{figure}
\begin{corollary}
    $|S| = \deg u\quad |T| = \deg v \implies \deg u + \deg v \leqslant n-1$
\end{corollary}
     
\begin{corollary}
    $\deg u < \frac{n}{2}$
\end{corollary}

Вершины: $1, 2, 3, \ldots, k, \ldots,  p (\text{верш. }u), \ldots, n$

$\sphericalangle i: i\in S\quad uu_{i+1}\in E$
\begin{lemma}
$\forall i\in S\quad \deg u_i \leqslant  \deg u< \frac{n}{2}$
\end{lemma}
\begin{proof}
    $i\in S \implies i\not\in T \implies u_iv\not\in E\implies \deg u_i+\deg v\leqslant \deg u + \deg v$. 

    $p\geqslant \deg u = d_p$
    
    $k = \deg u, k\leqslant p \implies d_k\leqslant d_p = \deg u = k < \frac{n}{2}$

    По ($\ast$) $d_{n-k} \geqslant  n-k >  \frac{n}{2}$ 

    \begin{lemma}
        $\exists  \geqslant k+1$ вершин степени $ \geqslant  n-k$
    \end{lemma}
    \begin{corollary}
        $\exists w: \deg w\geqslant n-k, w$ -- не сосед $u\quad uw\not\in E\quad \deg u + \deg w \geqslant  k+n-k=n > n-1 \geqslant  \deg u + \deg v$
    \end{corollary}

    $\left( \ast \right) \quad d_k\leqslant k<\frac{n}{2} \implies d_{n-k}>n-k$
\end{proof}
\end{proof}

\begin{theorem}
    [Оре]

    $\forall uv\not\in E\quad\deg u + \deg v \geqslant n$, то $G$ содержит гамильтонов цикл
\end{theorem}

\begin{definition}
    Ориентированный граф называется турниром, если между любой парой вершин существует ровно одно ребро (в одну из сторон)
\end{definition}
\begin{theorem}
    [Редеи, Камеон]

    $\forall $ турнир содержит гамильтонов путь

    Любой сильно связный ткрнир содержит гамильтонов цикл
\end{theorem}

\section{Рисуем графы}

\begin{statement}
    Любой граф можно вложить в $\R^3$
\end{statement}
\begin{proof}
    сопоставим каждой вершине случаную точку с раномерным распределением. Рёбра -- отрезки между ними. Рёбра пересекутся с вероятностью 0. Значит существует способ вложить граф в $\R^3$ без пересечений.

    Другое доказательство: нарисуем на плоскости и там, где есть пересечние двух, одним ребром выёдем из плоскости в $\varepsilon-$ окрестности.
\end{proof}

\begin{theorem}
    [Формула Эйлера] Связный $G, V, E$. Уложим на плоскость, получим $F$ граней.

    Тогда  $V+F-E=2$
\end{theorem}
\begin{proof}
    \begin{itemize}
        \item []
        \item [база] $1+1-0 = 2$
        \item [переход] $G$ содержит вершину  $\deg u = 1\quad G \setminus u: \begin{cases}
            V+=1\\
            E+=1\\
            F--const
        \end{cases}$ 

        Если такой нет, рассмотрим $uv$ не мост.
    \end{itemize}
\end{proof}

$21 = 3F\leqslant \sum\limits_{\text{f -- грань}}C_f = 2E = 20$ 

хмм, кажется предположение, что $C_5$ можно уложить неверно.

$3F\leqslant 2E$

$3\left( 2 + E - V \right) \leqslant 2E$

$6 + 3E - 3V \leqslant  2E$

\begin{statement}
\[E\leqslant  3V-6\]
\end{statement}

\begin{lemma}
    Дерево можно уложить
\end{lemma}

\begin{lemma}
    Если $G$ содержит мост  $uv$ и  в $G\setminus uv$ можно уложить любую компоненту связности, то $G$ можно уложить
\end{lemma}

\begin{theorem}
    Граф $G$ можно уложить на плоскости тогда и только тогда, когда  $G$ можно уложить на сфере.
\end{theorem}
\begin{proof}
    Есть биекция между сферой без точки и плоскостью
\end{proof}

\begin{corollary}
    $G$ - планарен, то любая вершина(грань) может лежать на внешней грани.
\end{corollary}

\begin{proof}
    [Леммы]

    Сделаем, чтобы вершины моста лежали на внешней и грани и соединим их. ??? profit
\end{proof}

\begin{lemma}
    $G$ содержит точку сочленения и любая компонента связности расчленения графа по этой вершине планарна, то  $G$ планарен.

    Расчленение -- удаление вершины с инцидентными рёбрами и добавление её отдельно независимо в каждую из получившихся компонент связности.
\end{lemma}

\begin{definition}
    $G_1, G_2$ -- гемеоморфны, если один в другой можно перевести конечной последовательностью следующих операций:
    \begin{itemize}
        \item Убрать вершину степени 2,  объединив два её ребра в одно
        \item Добавить в ребро вершину степени 2.
    \end{itemize}

    гомеоморфизм не влияет на укладку, гемеоморфность отношение эквивалентности.
\end{definition}

\begin{theorem}
    [Понтрягина-Куратовского]
    Граф $G$ планарен тогда и только тогда, когда  $G$ не содержит подграфов, гомеоморфных  $K_5$ или $K_{3,3}$
\end{theorem}
\begin{proof}
    $G$ -- минимальное число вершин и рёбер.  $G$ -- не планарен,  $G$ не содержит  $K_5$ или $K_{3,3}$ как гомеоморфные подграфы. Нет мостов, нет точек сочления, есть связность (всё из этого гарантирует неминимальность по числу вершин или рёбер)

    Возьмём какое-то его ребро $uv$ и удалим. гомеомофрных графов в $G$ не появилось от удаления, он всё ещё планарен.

    \begin{lemma}
        $G\setminus uv$ не содержит мостов и точек сочленения

        Пусть есть мост


    \end{lemma}
%\begin{figure}[!ht]
%    \centering
%    \incfig{estmost}
%    \caption{estmost}
%    \label{fig:estmost}
%\end{figure}


    $\sphericalangle $ цикл, содержащий $u$ И  $v$:  $C$ и укладку  $G \setminus  uv$, чтобы внутри $C$ было как можно больше граней. При удалении этого цикла, граф распадётся на внутренние компоненты цикла и внешние. Каждая компонента связности имеет рёбра с циклом  $C$


\begin{figure}[!ht]
    \centering
    \incfig{komponents}
    \caption{komponents}
    \label{fig:komponents}
\end{figure}

     \begin{lemma}
         любая внешняя компонента является разделяемой
    \end{lemma}

    \begin{lemma}
        Существует хотя бы одна внутренняя разделяющая компонента.
    \end{lemma}

    \begin{lemma}
        Существует внутренняя компонента, которая разделяет $u$ и  $v$, а также  $a$ и  $b$ одновременно
    \end{lemma}

\begin{figure}[!ht]
    \centering
    \incfig{rasdelat}
    \caption{rasdelat}
    \label{fig:rasdelat}
\end{figure}
\end{proof}



\section{Раскраски графов}

Все графы здесь будут неориентированы.

\begin{definition}
    Раскраской графа в $k$ цветов -- отображение $\varphi$, сопоставляющее каждой вершине число от $1$ до $k$, так что для любых двух смежных вершин  $uv\in E\quad \varphi(u)\neq \varphi(v)$
\end{definition}

\begin{example}
    $k = 2$
\end{example}

\begin{figure}[!ht]
    \centering
    \incfig{k2}
    \caption{k2}
    \label{fig:k2}
\end{figure}

\begin{statement}
    Раскраска в два цвета существует $\iff $ в $G$ нет нечётных циклов
\end{statement}
\begin{proof}
    \begin{itemize}
        \item []
        \item [$\implies $] Очевидно (картинка)
        \item [$\impliedby $] $dist(1,v) \% 2 = 0 \implies \varphi(v) =1\quad$ иначе $\varphi(v) = 2$
    \end{itemize}
\end{proof}

В 3 цвета и дальше уже NP-полная задача

\begin{note}
    $G, x$ цветов

    $P(G, x)$ -- хроматический многочлен графа G --  количество раскрасок  $G$ в  $x$ цветов

     \begin{enumerate}
         \item $P(O_n, x) - x^n$
         \item  $P(K_n, x) = A_x^n = x(x-1)(x-2)\ldots (x-n+k + 1)$ 
         \item $P(T_n, x) = P\left( T_{n-1}, x \right) \cdot (x-1) = P\left( T_1, x \right) \cdot (x-1)^{n-1} = x\left( x-1 \right) ^{n-1}$
    \end{enumerate}
\end{note}

\begin{statement}
    $\forall G\quad P(G, *)$ -- многочлен и $\deg P(G, *) = n$
\end{statement}
\begin{proof}
    Если убрать одно ребро, то ограничений станет меньше, раскрасок больше и мы посчитаем лишние. Какие? Те, в которых две вершины, соединённые тем ребром имеют один цвет. Найдём количество раскрасок, в которых две фиксированные смежные вершины имеют один цвет. Для этого стянем эти две вершины

    $P(G, x) = P\left( G\setminus \{uv\}, x \right) - P\left( G / uv,x \right)  $ 

    База: $P(O_n, x) = x^n$

    Переход:  $P(G,x)$ -- разность многочленов степени  $n$ и  $n-1$
\end{proof}

\begin{note}
    $P(O_n, x) = x^n + 0\cdot x^{n-1}$

    $P(T_n,x) = x(x-1)^{n-1} = x^n - (n+1)x^{n-1} + \ldots$

    $P(K_n, x) = (x-0)(x-1)\ldots(x-(n-1)) = x^n - \binom n 2 x^{n-1} + \ldots$

    $P(G_n, x) = x^n - |E|x^{n-1} + \ldots$

    $P(G, x) = P\left( G\setminus uv, x \right)  - P\left( G / uv, x \right)  = x^n - (|E|-1)x^{n-1} + \ldots - x^{n-1} + \ldots = x^n - |E|x^{n-1} + \ldots$
\end{note}

\begin{definition}
    $\Chi(G)$ -- минимальное число цветов, для которых сущесвует раскраска графа  $G$ -- хроматическое число графа  $G$
\end{definition}

\begin{note}
    $\gamma(G)\leqslant k \implies \exists $ раскраска в $k+1$ цветов,  $\Chi(G)\leqslant \Delta(G) + 1$
\end{note}

\begin{theorem}
    [Брукс]

    $G$ -- связный,  $G\neq K_n$ или $C_{2n+1} \implies \Chi(G) \leqslant \Delta(G) = k$
\end{theorem}
\begin{proof}
    $k = 0\quad G = K_1$

    $k = 1\quad G = K_2$

    $k=2\quad G$ -- путь или чётный цикл, его можно раскрасить в два цвета

     $k\geqslant 3$

     Берём вершину с $\deg < k$, запускаем dfs, жадно красим

     $G$ --  $k$-регулярный, все вершины имеют степень  $k.\quad k < n-1$, иначе граф был бы полным. Между какими-то двумя вершинами нет ребра.  $uxv\quad uv$ ребра нет. Жадно продлеваем путь, не заходя в посещённые вершины:  $uxv v_4 v_5 \ldots v_r$
     \begin{enumerate}
         \item Мы получили гамильтонов путь. У вершины $x$ степень как минимум 3, значит у неё есть ещё какой-то сосед. Пусть у  $u,v$ -- цвет 1.
     \end{enumerate}
\end{proof}

\begin{statement}
    Любой планарный граф можно покрасить в 5 цветов
\end{statement}
\begin{proof}
    $\deg V_{min}\leqslant 4 \implies $ есть свободный цвет
\end{proof}

\begin{theorem}
..    
\end{theorem}

\section{Паросочетания}

\begin{definition}
    Паросочетание -- множество рёбер $M\subseteq E$, такое что никакие два ребра не имеют общих вершин \[\forall e, f\in M\quad e, f \text{не имееют общих концов}\]

    $\p \alpha(G)$ -- максимальное паросочетание в графе  $G$
\end{definition}

\begin{definition}
    $I \subseteq V$ -- независимое множество, если никакие две вершины из него не связаны ребром.

    $\alpha(G)$ -- максимальное независимое множество.
\end{definition}

\begin{definition}
    Вершинное покрытие -- множество вершин, такое что у каждого ребра хотя бы один конец в этом множестве.

    $\beta(G)$ -- минимальное вершинное покрытие
\end{definition}

\begin{definition}
    Рёберное покрытие -- множество рёбер, чтобы любая вершина являлась концом хотя бы одного ребра из этого множества

    $\p \beta(G)$ -- минимальное рёберное покрытие
\end{definition}

\begin{note}
    $\Chi(G)$ -- минимальное количестве цветов для вершинной покраски

    $\p \Chi(G)$ -- минимальное количество цветов для рёберной покраски
\end{note}

\begin{statement}
    $I$ -- независимое  $\iff V \setminus I$ -- вершинное покрытие
\end{statement}

\begin{corollary}
    $\alpha(G) + \beta(G) = n$
\end{corollary}

\begin{definition}
    Клика в графе -- множество вершин, в котором каждая пара вершин связана ребром.

    Изолированное множество иногда называют антикликой

    Размер максимальной клики в графе -- $\omega(G)$
\end{definition}

\begin{statement}
    $\alpha(G) = \omega(G)$
\end{statement}

\begin{definition}
    Паросочетание называется совершенным, если оно покрывает все вершины (является рёберным покрытием).
\end{definition}

\begin{corollary}
    $n$ -- нечётно  $\implies $ нет совершенного паросочетания
\end{corollary}

\begin{note}
    В еже на 4 вершины ($K_{1,3}$) совершенного паросочетания нет, значит условие не необходимое-и-достаточное.
\end{note}

\begin{definition}
    $o(G)$ -- числа нечётных компонент связности
\end{definition}

\begin{statement}
    Если $\exists A\subseteq V: |A| < o(G\setminus A)$, то в $G$ нет совершенных паросочетаний
\end{statement}

\begin{definition}
    Множество Татта -- множество, удалив которое в графе получается больше нечётных компонент связности, чем вершин в этом множестве
\end{definition}

\begin{theorem}
    [Татта]

    $G$ содержит совершенное парочочетание  $\iff \forall A \subseteq V\quad |A| \geqslant o(G\setminus A)$
\end{theorem}
\begin{proof}
   \begin{itemize}
       \item []
       \item [$\implies $] предыдущее утверждение
       \item [$\impliedby $]

           $A = \O  \implies  0\geqslant o(G) \implies $ количестве вершин в $G$ -- чётно 

           Предположим есть контрпример. Среди всех котрпримеров выберем с минимальным числом вершин, а среди них с максимальным числом рёбер.

           $G$ -- не полный граф, т.к. при чётном количестве вершин в нём было бы паросочетание.

            $\sphericalangle uv\not\in E\quad \sphericalangle G\cup uv = \p G$, может ли после такой опреации появиться множество Татта? Нет, не может.

            $o\left( \p G\setminus  A \right) = O(G\setminus A)$, если в $A$ одна из вершин  $u$ или $v$

             Если $u$ и $v$  в одной компоненте, то тоже равны

             Если в разных и одна из компонент нечётная, то равны. Если обе компоненты нечётны, то левая меньше

             Итого: $o\left( \p G\setminus A \right) \leqslant o\left( G \setminus  A \right) \leqslant |A|$

             Множества Татта появиться не могло, а значит добавление любого ребра приводит у полному паросочетанию

             $\forall uv\not\in E\quad G\cup uv$ содрежит совершенное паросочетание.

            $U = \left\{ u: deg u = n-1 \right\} $

            $U \neq  V$ (иначе он был бы полным)

             \begin{lemma}
                 $G\setminus U$ -- объединение полных графов
             \end{lemma}
             \begin{proof}
                 Предположим, что это не так. Значит в графе $G\setminus U$ есть хотя бы одна компонента, которая не полный граф. В ней хотя бы три вершины, т.к. две вершины соединённый ребром это полный граф.

                 Рассмострим три вершины $xyz$, т.ч.  есть рёбра  $xy$ И  $yz$, но не  $xz$ (если таких нет, то отношение соединённости рёбром транзитивно и граф полон).

                 Т.к.  $y\not\in U$, значит $\exists w: yw\not\in E$

                 $\sphericalangle G\cup xz$. По предыдущей лемме он содержит совершенное паросочетание $M_1$

               $\sphericalangle G\cup yw$. По лемме он содержит совершенное паросочетание $M_2$

               $\sphericalangle M_1 \bigoplus M_2$
             \end{proof}
   \end{itemize}
\end{proof}
....


\begin{definition}
    Граф называется фактор-критическим, если для любой его вершины граф $G\setminus u$ содержит совершенное паросочетание

    $K_{2n+1}\quad C_{2n+1}$

    $\p \alpha(G) = \p \alpha(G\setminus u) = \left\lfloor \frac{n}{2} \right\rfloor$
\end{definition}

\begin{theorem}
    [Галлаи]
    $G$ -- связный 

    $G$ -- фактор критический  $\iff \forall u\in v\quad \p \alpha(G\setminus u) = \p \alpha(G)$
\end{theorem}
\begin{proof}
    \begin{itemize}
        \item []
        \item [$\implies $] \checkmark
        \item [$\impliedby $] $G$ не содержит совершенного паросочетания  $\implies G$ содержит множество Татта $S$
             \begin{enumerate}
                 \item $S = \O \quad \deg G = (G) - 0 = 1 \implies \p\alpha(G) = \left\lfloor \frac{n}{2} \right\rfloor$
                 \item $\exists S\neq \O $ Выберем то, для которого $o\left( G\setminus S \right)  - |S| \to \max = \deg G = k$

                     $\sphericalangle v\in S\quad \p G = G \setminus v\quad \p S = S \setminus v$

                     $\deg \left( G\setminus v \right)  = \deg \p G \geqslant o\left( \p G \setminus  \p S \right) - \left| \p S \right|  = o\left( G\setminus S \right)  - |S| + 1 = k +1 \implies \p \alpha(G\setminus v) \leqslant \p \alpha(G) - 1$
            \end{enumerate}
     \end{itemize}
\end{proof}

\begin{definition}
    $D(G) = \left\{ u|\p \alpha\left( G\setminus u \right) = \p \alpha(G) \right\} $

    (для $u\quad \exists $ максимальное паросочетание $H$ не покрывающее  $u$)

    $A(G) = \left\{ u|u\not\in D(G), \exists v\in D(G): uv\in E \right\} = N(D)$

    $C(G) = V \setminus \left( D(G) \cup A(G) \right) $
\end{definition}

\begin{figure}[!ht]
    \centering
    \incfig{fac}
    \caption{FAC}
    \label{fig:fac}
\end{figure}

\begin{lemma}
    [О стабильности]

    $a\in A(G)$. Тогда  $\begin{cases}
        A(G\setminus a) = D(G)\\
        A(G\setminus a) = A\left(G \right) \setminus a\\
        C(G\setminus a) = C(G)\\
        \p\alpha(G\setminus a) = \p \alpha(G) - 1
    \end{cases}$
\end{lemma}
\begin{proof}
    $\sphericalangle u\in D(G)\quad \exists M$ -- максимальное паросочетание $G$,  $u$ не покрывается  $M$.  $\exists ax\in M\quad M\setminus ax$ -- паросочетание $G\setminus a$, не покрывающее $u$

    $v\not\in D(G)$. $\sqsupset \exists $ максимальное парочсочетание графа $G\setminus a$, не покрываюшее $v$. $\exists w$ -- сосед $a$ в  $D(G)$

    $M_{w}$ -- максимальное паросочетание $G$, не покрывающее $w$,  $M_w$ покрывает  $v$

     $\p M \bigoplus M_w$

      \begin{enumerate}
          \item $v$ -- конец пути чётной длины  $P$, тогда $M_w\bigoplus P$ -- паросочетание того же размера, не покрывающее  $r \implies  r\in D(G)$
          \item $v$ и  $a$ -- концы одного пути.  $M_w \bigoplus P \cup aw$ -- паросочетание того же размера, не покрывающее $v \implies v\in D(G)$
          \item $v$ -- конец нечётного пути  $P$, второй конец не  $a$. Тогда  $\p M \bigoplus P$ -- паросочетание в  $G\setminus a$, имеющее больший размер
     \end{enumerate}
\end{proof}

\begin{theorem}
    [Галлаи, Эдмондс]

    $G$ -- граф,  $D_1, \ldots, D_k$ -- к. св. $D(G)$
     \begin{enumerate}
         \item $C(G)$ имеет совершенное паросочетание
         \item  $D_1, D_2, .., D_k$ -- фактор-критические
         \item $\forall $ максимальное паросочетние $G$ :
             \begin{itemize}
                 \item совершенное паросочетание $C(G)$
                 \item почти совершенное паросочетание в  $D_1, \ldots, D_k$
                 \item $\forall $ вершина из $A(G)$  покрывается ребром в $D(G)$
             \end{itemize}
         \item $\Def G  = k - |A|$
    \end{enumerate}
\end{theorem}
\begin{proof}
    $\begin{cases}
        D(G\setminus A) = D(G)\\
        A(G\setminus A) = \O \\
        C(G\setminus A) = C(G)\\
        \p\alpha\left( G\setminus A \right)  = \p \alpha(G) - |A|
    \end{cases}$ 

    $C(G)$ имеет совершенное паросочетание

    $\p\alpha(D_i \setminus  u) = \p \alpha(D_i)$ для любого $u\in D-i \implies $ по теореме Галлаи $D_i$ -- фактор-критические графы

     $\sphericalangle M$ -- максимальное паросочетание в $G$

     $\left| \p M \right| \geqslant \left| M \right|  - |A| = \p \alpha(G) - |A| = \p \alpha(G\setminus A) \implies \p M$ -- максмальное паросочетание в $G \setminus A \implies \p M = M_C \cup \bigcup\limits_{u=1}^k M_{D_i}$
\end{proof}

\begin{problem}
    [Задача о факторе в графе]

    $G, k$-фактор

     $V, E_k\subseteq E$

     $\forall v\quad \deg_{E_k}v = k$

     1-фактор -- совершенное паросочетание

     2-фактор -- разбиение на циклы

     3-фактор -- кубическая декомпозиция
\end{problem}

\begin{definition}
    [$f$-фактор]
    $f = \left( f_1, \ldots, f_n \right) $

    $V, E_f\subseteq E$

    $\deg_{E_f}v = f_v$

    $k$-фактор --  $f$-фактор,  $f_i = k$
\end{definition}

%\begin{figure}[!ht]
%    \centering
%    \incfig{excess}
%    \caption{excess}
%    \label{fig:excess}
%\end{figure}

Для каждого ребра создаём копию вершин и создаём вершины избытка. Находим совершенное паросочетание.
\end{document}
